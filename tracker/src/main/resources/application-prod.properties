# ==== PRODUCTION CONFIGURATION ====
# This file contains production-specific settings
# Use: java -jar app.jar --spring.profiles.active=prod

# ==== Server Configuration ====
server.port=${PORT:8080}
server.servlet.context-path=/

# ==== PostgreSQL Database Configuration ====
# Use environment variables for production credentials
spring.datasource.url=${DATABASE_URL:jdbc:postgresql://localhost:5432/myproject}
spring.datasource.username=${DATABASE_USERNAME:postgres}
spring.datasource.password=${DATABASE_PASSWORD:newpassword}
spring.datasource.driver-class-name=org.postgresql.Driver

# ==== JPA / Hibernate ====
spring.jpa.database-platform=org.hibernate.dialect.PostgreSQLDialect
spring.jpa.hibernate.ddl-auto=validate
spring.jpa.show-sql=false
spring.jpa.properties.hibernate.format_sql=false
spring.jpa.properties.hibernate.use_sql_comments=false

# ==== JWT Security ====
# Use strong secret in production (at least 256 bits)
jwt.secret=${JWT_SECRET:mySecretKey1234567890123456789012345678901234567890}
jwt.expiration=${JWT_EXPIRATION:3600000}

# ==== Flyway Database Migrations ====
spring.flyway.enabled=true
spring.flyway.baseline-on-migrate=true
spring.flyway.validate-on-migrate=true
spring.flyway.clean-disabled=true
spring.flyway.baseline-version=0
spring.flyway.baseline-description=Production baseline
spring.flyway.ignore-migration-patterns=*:missing
spring.flyway.out-of-order=true

# ==== Logging ====
logging.level.root=WARN
logging.level.com.portfolio.tracker=INFO
logging.level.org.springframework.security=WARN
logging.level.org.springframework.web=WARN

# ==== Performance ====
spring.jpa.properties.hibernate.jdbc.batch_size=20
spring.jpa.properties.hibernate.order_inserts=true
spring.jpa.properties.hibernate.order_updates=true
spring.jpa.properties.hibernate.jdbc.batch_versioned_data=true

# ==== CORS Configuration ====
# Restrict to your production domain
spring.web.cors.allowed-origins=${ALLOWED_ORIGINS:https://yourdomain.com}
spring.web.cors.allowed-methods=GET,POST,PUT,DELETE,OPTIONS
spring.web.cors.allowed-headers=*
spring.web.cors.allow-credentials=true

# ==== Swagger/OpenAPI ====
# Disable in production for security
springdoc.swagger-ui.enabled=false
springdoc.api-docs.enabled=false

# ==== Actuator Health Checks ====
management.endpoints.web.exposure.include=health,info
management.endpoint.health.show-details=when-authorized
management.endpoint.health.show-components=when-authorized

# ==== Security Headers ====
server.servlet.session.cookie.secure=true
server.servlet.session.cookie.http-only=true
server.servlet.session.cookie.same-site=strict

# ==== Rate Limiting ====
# Consider implementing rate limiting for production
# spring.cloud.gateway.default-filters=RequestRateLimiter=2, 10, 20, redis-rate-limiter

# ==== Monitoring ====
# Enable metrics for production monitoring
management.metrics.export.prometheus.enabled=true
management.metrics.enable.jvm=true
management.metrics.enable.process=true
management.metrics.enable.system=true
